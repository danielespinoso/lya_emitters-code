import sys
import time
import deepdish as dd
import numpy as np
import matplotlib.pyplot as plt


#####################  ATTENTION  ####################
# This code reads a general CSV input and formats
# it into a python dictionary (each column becomes a
# key in the dictionary). Obviously the exact structure
# of the input file can differ each time, thus some
# parameters/variables must be enabled/disabled
# manually depending on the input.
######################################################


#----------------------#
#       SETTINGS       #
#----------------------#
inp = '/home/CEFCA/dspinoso/works/lya_emitters/datasets/lqac/lqac3.dat'
out = '/home/CEFCA/dspinoso/works/lya_emitters/datasets/lqac/lqac3.h5'


#------------------------#
#    LOAD AND CONVERT    #
#------------------------#

data = np.genfromtxt(inp, skip_header=0, usecols=(3,4), unpack=False) # reading actual data

for i in range(len(data[:,0])):
    if data[i,0].dtype != np.float64:
        print 'NO'
        
table = {
    'coords' : np.array([data[:,0],data[:,1]]).T
}

dd.io.save(out, table)
